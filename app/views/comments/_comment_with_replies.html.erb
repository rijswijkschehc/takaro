<%= turbo_stream_from comment, :comments %>

<%= tag.div(class: 'ps-3 border-start', id: "#{dom_id(comment)}_with_comments", data: { controller: 'comment-reply' }) do %>
  <%= render comment %>

  <%= link_to _('Reply'), '#', data: { action: 'comment-reply#toggle' } %>
  <%= tag.div(id: "#{dom_id(comment)}_comments") do %>
    <%= render partial: 'comments/form',
               locals: { commentable: comment,
                         comment: Comment.new,
                         class: 'd-none',
                         data: { comment_reply_target: 'form' } } %>
    <%= render partial: 'comments/comment_with_replies', collection: comment.children, as: :comment %>
  <% end %>
<% end %>
